rule malware_goshell_0 {
    meta:
        author      = "c3rb3ru5d3d53c"
        description = "GoShell Shellcode Injector"
        reference   = "https://twitter.com/c3rb3ru5d3d53c/status/1365438427735457799"
        hash        = "a70b749e1d8a236e343ddbdf9d19e7b8"
        type        = "malware.loader/malware.downloader"
        created     = "2021-02-27"
        os          = "windows"
        tlp         = "white"
        rev         = 1
    strings:
        $golang_0 = "vendor/golang" ascii nocase
        $uniq_0   = ".GetShellcode" ascii wide nocase
        $hex_0    = "\\x"           ascii wide nocase
        $hex_1    = "hex.Decode"    ascii wide nocase
        $net_0    = /https?:\/\//   ascii wide nocase
        $net_1    = "GET"           ascii wide
        $net_2    = "net/http"      ascii wide nocase
        $cert_0   = {30 82 ?? ?? 30 82 ?? ??}
    condition:
        uint16(0) == 0x5a4d and
        uint32(uint32(0x3c)) == 0x00004550 and
        filesize > 5MB and not
        $cert_0 and
        #golang_0 > 64 and
        $uniq_0 and
        1 of ($hex_*) and
        1 of ($net_*)
}
