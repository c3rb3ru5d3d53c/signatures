rule malware_hellokitty_0 {
    meta:
        author      = "c3rb3ru5d3d53c"
        description = "HelloKitty Ransomware"
        hash        = "06ce6cd8bde756265f95fcf4eecadbe9"
        reference   = "https://twitter.com/malwrhunterteam/status/1359247085812527104"
        type        = "malware.ransomware"
        created     = "2021-02-09"
        os          = "windows"
        tlp         = "white"
        rev         = 1
    strings:
        $mutex_0  = "HelloKittyMutex"   ascii wide nocase
        $note_0   = "decrypt"           ascii wide nocase
        $note_1   = ".onion"            ascii wide nocase
        $note_2   = " pay "             ascii wide nocase
        $ransom_0 = "ShadowCopy"        ascii wide nocase
        $code_0   = {c7 4? ?? 23 04 00 00 c7 4? ?? 43 08 00 00 c7 4? ?? 3f 04 00 00 c7 4? ?? 37 04 00 00 c7 4? ?? 2c 08 00 00 c7 4? ?? 27 04 00 00 c7 4? ?? 26 04 00 00 c7 4? ?? 40 04 00 00 c7 4? ?? 28 04 00 00 c7 4? ?? 2b 04 00 00 c7 4? ?? 42 04 00 00 c7 4? ?? 25 04 00 00}
        $code_1   = {c7 84 ?? ?? ?? ?? ?? 85 ae 67 bb c7 84 ?? ?? ?? ?? ?? 72 f3 6e 3c c7 84 ?? ?? ?? ?? ?? 3a f5 4f a5 c7 84 ?? ?? ?? ?? ?? 7f 52 0e 51 c7 84 ?? ?? ?? ?? ?? 8c 68 05 9b c7 84 ?? ?? ?? ?? ?? ab d9 83 1f c7 84 ?? ?? ?? ?? ?? 19 cd e0 5b}
    condition:
        uint16(0) == 0x5a4d and
        uint32(uint32(0x3c)) == 0x00004550 and
        $mutex_0 and
        1 of ($note_*) and
        $ransom_0 and
        1 of ($code_*)
}
