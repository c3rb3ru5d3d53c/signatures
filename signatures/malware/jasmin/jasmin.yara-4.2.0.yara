import "pe"

rule malware_jasmin_0 {
    meta:
        author      = "c3rb3ru5d3d53c"
        description = "Jasmin Ransomware"
        reference   = "https://twitter.com/c3rb3ru5d3d53c/status/1370740134937772037"
        hash        = "eabb920f75c2943113713849878a6dfb"
        type        = "malware.ransomware"
        created     = "2021-03-13"
        os          = "windows"
        tlp         = "white"
        rev         = 1
    strings:
        $handshake_0 = "VXpCMk1UTjBjMU14YkhZemNsSTBibk13YlhjMGNqTQ" ascii wide nocase
        $uniq_0      = "machine_name"                               ascii wide
        $uniq_1      = "computer_user"                              ascii wide
        $uniq_2      = "systemid"                                   ascii wide
        $uniq_3      = "os"                                         ascii wide
        $uniq_4      = "ip"                                         ascii wide
        $uniq_5      = "location"                                   ascii wide
        $uniq_6      = "password"                                   ascii wide
        $uniq_7      = ".ss"                                        ascii wide
    condition:
        uint16(0) == 0x5a4d and
        uint32(uint32(0x3c)) == 0x00004550 and
        pe.imports("mscoree.dll") and
        filesize < 1334KB and
        $handshake_0 and
        3 of ($uniq_*)
}
