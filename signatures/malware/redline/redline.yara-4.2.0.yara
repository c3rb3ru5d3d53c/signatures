import "pe"

rule malware_redline_stealer_0 {
    meta:
        author      = "c3rb3ru5d3d53c"
        description = "RedlineStealer"
        reference   = "https://twitter.com/siri_urz/status/1342042496419983360"
        hash        = "726ebba161def46dfe9c32bdd2699c50"
        type        = "malware.stealer"
        created     = "2020-12-24"
        os          = "windows"
        tlp         = "white"
        rev         = 1
    strings:
        $stealer_0     = "Vivaldi"               ascii wide nocase
        $stealer_1     = "Chrome"                ascii wide nocase
        $stealer_2     = "Epic Privacy Browser"  ascii wide nocase
        $stealer_3     = "Chedot"                ascii wide nocase
        $stealer_4     = "QIP Surf"              ascii wide nocase
        $stealer_5     = "Orbitum"               ascii wide nocase
        $stealer_6     = "Maxthon"               ascii wide nocase
        $stealer_7     = "K-Melon"               ascii wide nocase
        $stealer_8     = "Amigo"                 ascii wide nocase
        $stealer_9     = "Torch"                 ascii wide nocase
        $stealer_10    = "Chromodo"              ascii wide nocase
        $stealer_11    = "CocCoc"                ascii wide nocase
        $stealer_12    = "Opera Software"        ascii wide nocase
        $stealer_13    = "Elements Browser"      ascii wide nocase
        $stealer_14    = "Iridium"               ascii wide nocase
        $stealer_15    = "Sputnik"               ascii wide nocase
        $stealer_16    = "Nichrome"              ascii wide nocase
        $stealer_17    = "Waterfox"              ascii wide nocase
        $stealer_18    = "Thunderbird"           ascii wide nocase
        $stealer_19    = "NETGATE Technologies"  ascii wide nocase
        $stealer_20    = "Win32_Processor"       ascii wide nocase
        $stealer_21    = "Win32_VideoController" ascii wide nocase
        $stealer_22    = "Win32_DiskDrive"       ascii wide nocase
        $stealer_23    = "exodus.wallet"         ascii wide nocase
        $stealer_24    = "Electrum"              ascii wide nocase
        $stealer_25    = "Ethereum"              ascii wide nocase
        $stealer_26    = "logins.json"           ascii wide nocase
        $stealer_27    = "cookies.sqlite"        ascii wide nocase
        $stealer_28    = "wallet_path"           ascii wide nocase
        $redline_class = "RedLine."              ascii nocase
    condition:
        uint16(0) == 0x5a4d and
        uint32(uint32(0x3c)) == 0x00004550 and
        pe.imports("mscoree.dll") and
        14 of ($stealer_*) and
        #redline_class > 4
}
