import "dotnet"

rule redline_0 {
    meta:
        author      = "@c3rb3r3u5d3d53c"
        description = "Redline Stealer"
        created     = "2023-02-25"
        tlp         = "white"
        reference   = "https://c3rb3ru5d3d53c.github.io/2023/02/opaque-predicate-hunting-with-yara/"
        rev         = 1
    strings:
        $string_decrypt_method = {
            73 ?? ?? ?? ?? 0a 16 0b 2b ?? 02 07 6F ?? ?? ??
            ?? 03 07 03 6F ?? ?? ?? ?? 5d 6F ?? ?? ?? ?? 61
            0c 06 72 ?? ?? ?? ?? 08 28 ?? ?? ?? ?? 6F ?? ??
            ?? ?? 26 07 17 58 0b 07 02 6F ?? ?? ?? ?? 32 ??
            06 6F ?? ?? ?? ?? 2a
        }
        $typedef_0 = "РrоtoнVРN" ascii wide
        $typedef_1 = "M03illa"   ascii wide
    condition:
        uint16(0) == 0x5a4d and
        dotnet.is_dotnet and
        $string_decrypt_method and
        1 of ($typedef_*)
}
