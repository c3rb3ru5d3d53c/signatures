rule malware_emotet_0 {
    meta:
        author      = "c3rb3ru5d3d53c"
        description = "Emotet Botnet 64-bit"
        hash        = "6ec63509783dee7bb2965978bdb8ce0af9143cd889ac407f64dfc77cbc4b82f0"
        type        = "malware.botnet"
        created     = "2022-05-08"
        os          = "windows"
        tlp         = "white"
        rev         = 1
    strings:
        $trait_group_0_0 = { 8b c7 41 0f b7 4c 45 00 41 8b 1c 8c 48 03 dd 48
                             3b de 72 1b }
        $trait_group_0_1 = { 48 8b c4 48 89 48 ?? 48 89 50 ?? 4c 89 40 ?? 4c
                             89 48 ?? c3 }
        $trait_group_0_2 = { 48 8b 45 ?? bb 01 00 00 00 48 89 07 8b 45 ?? 89
                             47 ?? 4c 8d 9c 24 ?? ?? ?? ?? 8b c3 49 8b 5b ??
                             49 8b 73 ?? 49 8b 7b ?? 49 8b e3 5d c3 }
        $trait_group_0_3 = { 48 39 3b 4c 8d 9c 24 ?? ?? ?? ?? 49 8b 5b ?? 49
                             8b 73 ?? 40 0f 95 c7 8b c7 49 8b 7b ?? 49 8b e3
                             5d c3 }
        $trait_group_0_4 = { 43 8b 84 fe ?? ?? ?? ?? 48 03 c6 48 3b d8 73 0b }
        $trait_group_1_0 = { be 02 00 00 00 4c 8d 9c 24 ?? ?? ?? ?? 8b c6 49
                             8b 5b ?? 49 8b 73 ?? 49 8b 7b ?? 49 8b e3 41 5f
                             41 5e 41 5d 41 5c 5d c3 }
        $trait_group_1_1 = { 88 02 48 ff c2 48 ff c3 8a 03 84 c0 75 ee }
        $trait_group_1_2 = { 4c 8d 9c 24 ?? ?? ?? ?? 8b c3 49 8b 5b ?? 49 8b
                             73 ?? 49 8b 7b ?? 49 8b e3 5d c3 }
    condition:
        uint16(0) == 0x5a4d and
        uint32(uint32(0x3c)) == 0x00004550 and
        2 of ($trait_group_0_*) and
        2 of ($trait_group_1_*)
}
