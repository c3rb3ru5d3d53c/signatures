rule malware_tortoise_0 {
    meta:
        author      = "c3rb3ru5d3d53c"
        description = "Tortoise Ransomware"
        reference   = "https://id-ransomware.blogspot.com/2021/02/tortoise-ransomware.html"
        hash        = "c63d7d2943f5c99d05c314485940bf94"
        type        = "malware.ransomware"
        created     = "2021-02-13"
        os          = "windows"
        tlp         = "white"
        rev         = 1
    strings:
        $py_0   = "Py_SetPythonHome"      nocase ascii wide fullword
        $py_1   = "Python DLL"            nocase ascii wide fullword
        $uniq_0 = "encoder.exe.manifest"  ascii wide nocase
        $uniq_1 = "bencoder.exe.manifest" ascii wide nocase
        $uniq_2 = "pyAesCrypt"            ascii wide nocase
        $hex_0  = {70 79 74 68 6f 6e ?? ?? 2e 64 6c 6c}
    condition:
        uint16(0) == 0x5a4d and
        uint32(uint32(0x3c)) == 0x00004550 and
        filesize > 5MB and
        all of them
}
